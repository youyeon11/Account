<h1><Strong>Accoutn(계좌) 시스템 개발</Strong></h1>
<hr>
<h2> 01. 프로젝트 생성 </h2>
<p> 기본적으로 테스트 때까지 활용했던 코드들을 그대로 스켈레톤으로 활용. 일부 필요 없는 클래스를 삭제한다. </p>
[source code github] (https://github.com/snow-in-summer/Account/tree/lecture/part03_chapter02)

<h3>기획자들의 요구 사항</h3>

>우리 회사는 신규 사업으로 핀테크를 하려고 한다.
>핀테크를 하려면 제일 먼저 필요한 것은 바로 사용자들 마다의 잔액을 관리할 수 있는 계좌 시스템! </p>
>계좌 시스템이 있어야 사용자의 잔액을 우리 회사에서 계속 관리하고 사용자들은 그 잔액을 쓰기 위해 우리의 핀테크를 자연스럽게 사용하게 된다.
>계좌 시스템을 만들어주세요.

<h3> 기획자들이 사업을 구체화 </h3>

>Account(계좌) 시스템은 사용자와 계쫘의 정보를 저장하고 있으며,
>외부 시스템에서 거래를 요청할 경우 거래 정보를 받아서 계좌에서 잔액을 거래금액만큼 줄이거나(결제),
>거래금액만큼 늘리는(결제 취소) 거래 관리 기능을 제공하는 시스템이다.
>
>크게 <Strong>사용자, 계좌, 거래</Strong> 의 정보를 저장해야한다.
>
><Strong>사용자</Strong>는 신규 등록, 해지, 중지, 사용자 정보 조회 등의 기능을 제공해야하지만,
>최초 버전에서는 빠른 서비스 오픈을 위해 사용자 등록, 해지, 중지 기능은 제공하지 않고 DB로 수기입력을 합니다.
>
><Strong>계좌</Strong>는 계좌 추가, 해지, 확인 기능을 제공합니다.
>한 사용자는 최대 10개의 계좌를 가질 수 있고 그 이상의 계좌는 생성하지 못한다.
>계좌 번호는 10자리의 정수로 이루어지며 중복이 불가능하다. 빠르고 안정적인 진행을 위해 계좌번호는 순차 증가하도록 한다.
>
><Strong>거래</Strong>는 잔액 사용, 잔액 사용 취소, 거래 확인 기능을 제공합니다.
<br>
<h3> 개발자들은 기획 내용을 어떻게 개발할지 검토 </h3>
개발자들은 기획 내용을 어떻게 개발할지 검토
1. 기술 스택 결정
Spring boot와 Java를 활용합니다.
DB는 H2 DB(memory DB 모드)를 활용합니다.
DB를 접근하는 방법은 Spring data jpa를 활용합니다.
Embedded redis를 활용합니다.
API Request body와 Response body는 json 타입으로 표현합니다.
각각의 API들은 각자의 요청과 응답 객체 구조를 갖습니다.
다만, 요청을 처리하다가 실패하는 경우의 응답은 공통된 구조를 갖도록 합니다.

2. 각 기능 별 구체적인 명세서 생성
사용자
H2 DB를 사용하고 샘플로 생성하는 강의이니 구현의 편의를 위해 사용자 정보가
어플리케이션 구동될 때 자동으로 저장되도록 하자.
계좌
계좌 생성 API
POST /account
파라미터 : 사용자 아이디, 초기 잔액

3-2 Account(계좌) 시스템 개발 4
정책 : 사용자가 없는 경우, 계좌가 10개(사용자당 최대 보유 가능 계좌 수)인
경우 실패 응답
성공 응답 : 사용자 아이디, 계좌번호, 등록일시
계좌 해지 API
DELETE /account
파라미터 : 사용자 아이디, 계좌 번호
정책 : 사용자 또는 계좌가 없는 경우, 사용자 아이디와 계좌 소유주가 다른 경
우, 계좌가 이미 해지 상태인 경우, 잔액이 있는 경우 실패 응답
성공 응답 : 사용자 아이디, 계좌번호, 해지일시
계좌 확인 API
get /account?user_id={userId}
파라미터 : 사용자 아이디
정책 : 사용자 없는 경우 실패 응답
성공 응답 : List<계좌번호, 잔액> 구조로 응답
거래 정보
잔액 사용 API
POST /transaction/use
파라미터 : 사용자 아이디, 계좌 번호, 거래 금액
정책 : 사용자 없는 경우, 사용자 아이디와 계좌 소유주가 다른 경우, 계좌가 이
미 해지 상태인 경우, 거래금액이 잔액보다 큰 경우, 거래금액이 너무 작거나
큰 경우 실패 응답
해당 계좌에서 거래(사용, 사용 취소)가 진행 중일 때 다른 거래 요청이 오
는 경우 해당 거래가 동시에 잘못 처리되는 것을 방지해야 한다.
성공 응답: 계좌번호, 거래 결과 코드(성공/실패), 거래 아이디, 거래금액, 거래
일시
잔액 사용 취소 API
POST /transaction/cancel

3-2 Account(계좌) 시스템 개발 5

파라미터 : 거래 아이디, 취소 요청 금액
정책 : 거래 아이디에 해당하는 거래가 없는 경우, 거래금액과 거래 취소 금액
이 다른경우(부분 취소 불가능) 실패 응답
1년이 넘은 거래는 사용 취소 불가능
성공 응답: 계좌번호, 거래 결과 코드(성공/실패), 거래 아이디, 거래금액, 거래
일시
거래 확인 API
GET /transaction/{transactionId}
파라미터 : 거래 아이디
정책 : 해당 거래 아이디의 거래가 없는 경우 실패 응답
성공 응답 : 계좌번호, 거래종류(잔액 사용, 잔액 사용 취소), 거래 결과 코드
(성공/실패), 거래 아이디, 거래금액, 거래일시
실패한 거래(사용/사용취소)도 거래를 확인할 수 있도록 합니다.
<br>
<br>
<br>
<hr>
<h2> 02. 설계 및 기본 구조 개발 </h2>
<h3> 패키지 구조 </h3>
- aop : AOP로 중복 거래 방지 락을 걸 때 사용될 어노테이션 등을 위치시킴
- config : redis 관련 설정 및 클라이언트 빈 등록, JPA 관련 설정 등록
- controller : API의 endpoint를 등록하고, 요청/응답의 형식을 갖는 클래스 패키지
- domain : jpa entity
- dto : DTO(Data Transafer Object)를 위치시키는 곳
* Controller에서 요청/응답에 사용할 클래스
* 로직 내부에서 데이터 전송에 사용할 클래스
- exception : 커스텀 Exception, Exception Handler 클래스 패키지
- repository : Repository(DB에 연결할 때 사용하는 인터페이스)가 위치하는 패키지
- service : 비즈니스 로직을 담는 서비스 클래스 패키지
- type : 상태타입, 에러코드, 거래종류 등의 다양한 enum class들의 패키지
<br>
<br>
<br>
<hr>
<h2> 03. 계좌 생성 API </h2>
<br>
<br>
<br>
<hr>
<h2> 04. 계좌 해지 API </h2>
<br>
<br>
<br>
<hr>
<h2> 05. 계좌 확인 API </h2>
<br>
<br>
<br>
<hr>
<h2> 06. 잔액 사용 API </h2>
<br>
<br>
<br>
<hr>
<h2> 07. 잔액 사용 취소 API </h2>
<br>
<br>
<br>
<hr>
<h2> 08. 잔액 사용 확인 API </h2>
